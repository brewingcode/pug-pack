# ----------------------------------------------------------------------------------------------------------------------
# best | Copyright (C) 2020 eth-p | MIT License
#
# Repository: https://github.com/eth-p/best
# Issues:     https://github.com/eth-p/best/issues
# ----------------------------------------------------------------------------------------------------------------------
if [[ "${#SUITE_FILES[@]}" -eq 0 ]]; then
	fatal_error "No test suites found."
fi

# ----------------------------------------------------------------------------------------------------------------------
# Functions:
# ----------------------------------------------------------------------------------------------------------------------

# shellcheck disable=SC2155
show_suite() {
	printc "%{SUITE_NAME}%s%{CLEAR} -- %{FILE}%s%{CLEAR}\n" "$SUITE_NAME" "$SUITE_FILE"
}

# ----------------------------------------------------------------------------------------------------------------------
# Overrides: Porcelain
# ----------------------------------------------------------------------------------------------------------------------
case "$PORCELAIN" in
	true) {
		show_suite_name() {
			:
		}

		show_suite() {
			printf "test_suite %s\n" "$SUITE_NAME"
			printf "test_suite_file %s\n" "$SUITE_FILE"
		}
	} ;;

	false) : ;;
	*) fatal_error 'unknown porcelain format: %s' "$PORCELAIN" ;;
esac

# ----------------------------------------------------------------------------------------------------------------------
# Main:
# ----------------------------------------------------------------------------------------------------------------------
for suite in "${SUITE_FILES[@]}"; do
	SUITE_FILE="$suite"
	SUITE_NAME="$(suite_name "$suite")"
	show_suite "$suite"
done
